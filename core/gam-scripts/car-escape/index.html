<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Car Parking - Driving Gam</title>
    <style>
      body {
        text-align: center;
        padding: 0;
        border: 0;
        margin: 0;
        background: #231F20;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        font-family: Arial, sans-serif;
      }
      
      #unity-container {
        position: relative;
        width: 100%;
        max-width: 600px; /* Maximum width for portrait */
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      
      #unity-canvas {
        background: #231F20;
        width: 100%;
        height: auto;
        max-height: 100vh;
        aspect-ratio: 9/16; /* Portrait aspect ratio - adjust as needed */
        display: block;
      }
      
      /* For mobile devices */
      @media screen and (max-width: 768px) {
        #unity-container {
          width: 100vw;
          height: 100vh;
          max-width: none;
        }
        
        #unity-canvas {
          width: 100vw;
          height: 100vh;
          max-height: none;
          aspect-ratio: unset;
        }
      }
      
      /* Force portrait on landscape mobile */
      @media screen and (orientation: landscape) and (max-width: 768px) {
        #unity-container {
          transform: rotate(90deg);
          transform-origin: center center;
          width: 100vh;
          height: 100vw;
          position: fixed;
          top: 50%;
          left: 50%;
          margin-top: -50vw;
          margin-left: -50vh;
        }
        
        #unity-canvas {
          width: 100%;
          height: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div id="unity-container">
      <canvas id="unity-canvas" width=960 height=600 tabindex="-1"></canvas>
    </div>
    <script src="/core/gam-scripts/car-escape/Build/hazel-cat-escape-hide-and-seek.loader.js"></script>
    <script>
      function setupCanvas() {
        const canvas = document.querySelector("#unity-canvas");
        
        if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
          // Mobile device setup
          let meta = document.querySelector('meta[name="viewport"]');
          if (!meta) {
            meta = document.createElement('meta');
            meta.name = 'viewport';
            document.getElementsByTagName('head')[0].appendChild(meta);
          }
          meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
          
          // Set canvas dimensions for mobile
          canvas.style.width = "100%";
          canvas.style.height = "100%";
          canvas.style.position = "fixed";
          
          document.body.style.textAlign = "left";
        } else {
          // Desktop setup - maintain portrait aspect ratio
          const container = document.querySelector("#unity-container");
          const containerWidth = container.clientWidth;
          const containerHeight = container.clientHeight;
          
          // Calculate dimensions to maintain portrait aspect ratio (9:16)
          const targetAspectRatio = 9/16;
          let canvasWidth, canvasHeight;
          
          if (containerWidth / containerHeight > targetAspectRatio) {
            // Container is too wide, limit by height
            canvasHeight = containerHeight;
            canvasWidth = canvasHeight * targetAspectRatio;
          } else {
            // Container is too tall, limit by width
            canvasWidth = containerWidth;
            canvasHeight = canvasWidth / targetAspectRatio;
          }
          
          canvas.style.width = canvasWidth + "px";
          canvas.style.height = canvasHeight + "px";
        }
      }
      
      // Setup canvas dimensions
      setupCanvas();
      
      // Recalculate on window resize
      window.addEventListener('resize', setupCanvas);
      window.addEventListener('orientationchange', function() {
        setTimeout(setupCanvas, 100); // Small delay to ensure orientation change is complete
      });

      createUnityInstance(document.querySelector("#unity-canvas"), {
        arguments: [],
        dataUrl: "/core/gam-scripts/car-escape/Build/hazel-cat-escape-hide-and-seek.data",
        frameworkUrl: "/core/gam-scripts/car-escape/Build/hazel-cat-escape-hide-and-seek.framework.js",
        codeUrl: "/core/gam-scripts/car-escape/Build/hazel-cat-escape-hide-and-seek.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Muhammad Arslan",
        productName: "Car Parking - Driving Games",
        productVersion: "1.0.2",
        matchWebGLToCanvasSize: true, // Enable this for proper scaling
        // devicePixelRatio: 1, // Uncomment this to override low DPI rendering on high DPI displays.
      }).then((unityInstance) => {
        console.log("Unity instance loaded successfully");
      }).catch((message) => {
        console.error("Failed to load Unity instance:", message);
      });

      // Block assignment to window.location
Object.defineProperty(window, 'location', {
  configurable: false,
  enumerable: true,
  writable: false,
  value: window.location
});

// Block setting window.location.href
Object.defineProperty(window.location, 'href', {
  configurable: false,
  enumerable: true,
  writable: false,
  value: window.location.href
});

// Override location.replace and location.assign to do nothing
window.location.replace = function() {
  console.log("Blocked location.replace()");
};
window.location.assign = function() {
  console.log("Blocked location.assign()");
};

// Optionally block top-level window.open as well (popups)
window.open = function() {
  console.log("Blocked window.open()");
  return null;
};

// Block common meta refresh redirects
const observer = new MutationObserver(() => {
  document.querySelectorAll('meta[http-equiv="refresh"]').forEach(meta => {
    meta.parentNode.removeChild(meta);
    console.log("Blocked meta refresh redirect");
  });
});
observer.observe(document.documentElement, { childList: true, subtree: true });

// Block form-based navigation
document.addEventListener("submit", function(e) {
  e.preventDefault();
  console.log("Blocked form submit redirect");
}, true);
    </script>
  </body>
</html>
