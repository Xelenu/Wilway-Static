<!DOCTYPE html>

<html lang="en-us">
<head><meta http-equiv="Content-Security-Policy" content="child-src 'self' *.allwebgames.com *.api.traffictourgame.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com blob: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; connect-src 'self' *.allwebgames.com *.api.traffictourgame.com *.eponesh.com *.gameanalytics.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.unity3d.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.net *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de wss://*.api.traffictourgame.com:* wss://*.eponesh.com:* wss://api.traffictourgame.com:* www.google-analytics.com www.googletagmanager.com yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yandexmetrica.com yastatic.net; default-src 'self' *.api.traffictourgame.com api.traffictourgame.com; font-src 'self' *.allwebgames.com *.api.traffictourgame.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com data: fonts.gstatic.com games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastat.net yastatic.net; frame-src 'self' *.allwebgames.com *.api.traffictourgame.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com games.yango.com gametok.com igrotok.com juegocasa.com localhost playhop.com wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastatic.net; img-src 'self' *.allwebgames.com *.api.traffictourgame.com *.eponesh.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.net *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastatic.net; media-src 'self' *.allwebgames.com *.api.traffictourgame.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.net *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; object-src 'self' *.allwebgames.com *.api.traffictourgame.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com blob: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; script-src 'self' 'unsafe-eval' 'unsafe-inline' *.allwebgames.com *.api.traffictourgame.com *.eponesh.com *.gameanalytics.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.ya.ru *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net abt.s3.yandex.net allwebgames.com api.traffictourgame.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de www.google-analytics.com www.googletagmanager.com ya.ru yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastatic.net; style-src 'self' 'unsafe-eval' 'unsafe-inline' *.allwebgames.com *.api.traffictourgame.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com api.traffictourgame.com blob: data: fonts.googleapis.com games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; worker-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz"/>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Traffic Tour</title>
<link rel="shortcut icon" href="TemplateData/favicon.ico"/>
<link rel="stylesheet" href="TemplateData/style.css"/>
</head>
<body>
<div id="unity-container" class="unity-desktop" style="width: 100%; height: 100%">
<canvas id="unity-canvas" width="auto" height="auto"></canvas>
<div id="unity-loading-bar">
<div id="unity-logo"></div>
<div id="unity-progress-bar-empty">
<div id="unity-progress-bar-full"></div>
</div>
</div>
<div id="unity-warning"> </div>
<div id="unity-footer">
</div>
</div>
<!-- Yandex Games Page Ads -->
<script type="text/javascript">

      function URefresh(id, render){
        (function(w, d, n, s, t) {
          w[n] = w[n] || [];
          w[n].push(function() {
            Ya.Context.AdvManager.render({
              blockId: id,
              renderTo: render,
              async: true
            });
          });
          t = d.getElementsByTagName("script")[0];
          s = d.createElement("script");
          s.type = "text/javascript";
          s.src = "//an.yandex.ru/system/context.js";
          s.async = true;
          t.parentNode.insertBefore(s, t);
        })(this, this.document,"yandexContextAsyncCallbacks");
      }
    
      function LoadAds(){
        URefresh("%UNITY_CUSTOM_BOTTOM_AD%", "bottomAd");
      }
      LoadAds();
      setInterval(LoadAds, 30000);
    </script>
<!-- Yandex Games SDK -->
<script src="sdk.js"></script>
<script type="text/javascript">
      var player;
      var sdk;
      var payments = null;
      let initSDK = false;
	  
      YaGames
	  .init()
	  .then(ysdk => {
		sdk = ysdk;
		sdk.adv.showFullscreenAdv({callbacks:{}});
      });

	  function setReady(){
		console.info('Ready.....');
        sdk.features.LoadingAPI?.ready();
      }

      function auth(){
        sdk.auth.openAuthDialog().then(() => {
                // Игрок успешно авторизован, теперь объект Player будет инициализирован.
                initPlayer();
                console.log('auth ok');
            }).catch(() => {
                 // Игрок не авторизован.
                 console.log('auth failed');
            });
      }

      function initPlayer(){
        return sdk.getPlayer().then(_player => {
                player = _player;  
                initSDK =true;				
            }).catch(err => {
                // Если игрок не авторизован, выбрасывает исключение USER_NOT_AUTHORIZED.
            });
      }
      function initPlayerAndgetUserData(){
        return sdk.getPlayer().then(_player => {
                player = _player;  
                initSDK =true;	
                getUserData();				
            }).catch(err => {
                // Если игрок не авторизован, выбрасывает исключение USER_NOT_AUTHORIZED.
            });
      }
      function getUserData(){
        if(initSDK)
		{
          var data = {"id" : player.getID(), "name" : player.getName(), "avatarUrlSmall" : player.getPhoto('small'), "avatarUrlMedium" : player.getPhoto('medium'), "avatarUrlLarge" : player.getPhoto('large')};
          unityInstance.SendMessage('YandexSDK', 'StoreUserData', JSON.stringify(data));
        }
		else
		{
		   console.log('initSDK =  false');
		   initPlayerAndgetUserData();        
		}
      }

      function showFullscrenAd(){
        sdk.adv.showFullscreenAdv({
          callbacks: {
		    onOpen: function()  {
             unityInstance.SendMessage('YandexSDK', 'OpenInterstitialAd');
			},
            onClose: function(wasShown) {
              unityInstance.SendMessage('YandexSDK', 'OnInterstitialShown');
            },
            onError: function(error) {
              unityInstance.SendMessage('YandexSDK', 'OnInterstitialFailed', error);
            }
          }
        })
      }

      function showRewardedAd(id){
        sdk.adv.showRewardedVideo({
        callbacks: {
            onOpen: () => {
                unityInstance.SendMessage('YandexSDK', 'OnRewardedOpen', id);
                console.log('YNR: VAO');
            },
            onRewarded: () => {
                unityInstance.SendMessage('YandexSDK', 'OnRewarded', id);
                console.log('YNR: Rdd');
            },
            onClose: () => {
                unityInstance.SendMessage('YandexSDK', 'OnRewardedClose', id);
                console.log('YNR: czd');
            }, 
            onError: (e) => {
                var data = {"id" : id, "error" : error};
                unityInstance.SendMessage('YandexSDK', 'OnRewardedError', JSON.stringify(data));
                console.log('YNR: Err', e);
            }
          }
        })
      }

      function initPayments(){
        sdk.getPayments().then(_payments => {
          // Покупки доступны.
          payments = _payments;
		  unityInstance.SendMessage('YandexSDK', 'OnIAPInitSuccess');
        }).catch(err => {
		  unityInstance.SendMessage('YandexSDK', 'OnIAPInitError', JSON.stringify(err));
        })
      }
	  
	  function getPurchases(){
		payments.getPurchases().then(purchases => {
			unityInstance.SendMessage('YandexSDK', 'OnGotUnprocessedPayments', JSON.stringify(purchases));
		});
      }
	  
	  function getProducts(){
		payments.getCatalog().then(products => {
			//gameShop = products;
			unityInstance.SendMessage('YandexSDK', 'OnGotProducts', JSON.stringify(products));
		});
	  }


      function purchase(id){
        payments.purchase(id).then(purchase => {
          // Покупка успешно совершена!
          unityInstance.SendMessage('YandexSDK', 'OnPurchaseSuccess', JSON.stringify(purchase));
        }).catch(err => {
          // Покупка не удалась: в консоли разработчика не добавлен товар с таким id,
          // пользователь не авторизовался, передумал и закрыл окно оплаты,
          // истекло отведенное на покупку время, не хватило денег и т. д.
          unityInstance.SendMessage('YandexSDK', 'OnPurchaseFailed', JSON.stringify(err));
        })
      }
	  
	  function consume(token){
        payments.consumePurchase(token);
      }

      //window.onbeforeunload = function(e) {
      //  console.log("Calling OnClose from Browser!");
      //  gameInstance.SendMessage("YandexSDK", "OnClose");
    
      //  var dialogText = "You game has been saved!  Would you like to continue unloading the page?";
      //  e.returnValue = dialogText;
      //  return dialogText;
      //};
    </script>
<script src="web3/index.js"></script>
<script>
      var container = document.querySelector("#unity-container");
      var canvas = document.querySelector("#unity-canvas");
      var loadingBar = document.querySelector("#unity-loading-bar");
      var progressBarFull = document.querySelector("#unity-progress-bar-full");
      var warningBanner = document.querySelector("#unity-warning");

      // Shows a temporary message banner/ribbon for a few seconds, or
      // a permanent error message on top of the canvas if type=='error'.
      // If type=='warning', a yellow highlight color is used.
      // Modify or remove this function to customize the visually presented
      // way that non-critical warnings and error messages are presented to the
      // user.
      function unityShowBanner(msg, type) {
        function updateBannerVisibility() {
          warningBanner.style.display = warningBanner.children.length ? 'block' : 'none';
        }
        var div = document.createElement('div');
        div.innerHTML = msg;
        warningBanner.appendChild(div);
        if (type == 'error') div.style = 'background: red; padding: 10px;';
        else {
          if (type == 'warning') div.style = 'background: yellow; padding: 10px;';
          setTimeout(function() {
            warningBanner.removeChild(div);
            updateBannerVisibility();
          }, 5000);
        }
        updateBannerVisibility();
      }

      var buildUrl = "Build";
      var loaderUrl = buildUrl + "/WebglBuild.loader.js";
      var config = {
        dataUrl: buildUrl + "/WebglBuild.data.unityweb",
        frameworkUrl: buildUrl + "/WebglBuild.framework.js.unityweb",
        codeUrl: buildUrl + "/WebglBuild.wasm.unityweb",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Wolves Interactive",
        productName: "Traffic Tour",
        productVersion: "2.6.7",
        showBanner: unityShowBanner,
      };

      // By default Unity keeps WebGL canvas render target size matched with
      // the DOM size of the canvas element (scaled by window.devicePixelRatio)
      // Set this to false if you want to decouple this synchronization from
      // happening inside the engine, and you would instead like to size up
      // the canvas DOM size and WebGL render target sizes yourself.
      // config.matchWebGLToCanvasSize = false;

      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
        // Avoid draining fillrate performance on mobile devices,
        // and default/override low DPI mode on mobile browsers.
        config.devicePixelRatio = 2;
        //unityShowBanner('WebGL builds are not supported on mobile devices.');
      } else {
        canvas.style.width = "100%";
        canvas.style.height = "100%";
      }
      loadingBar.style.display = "block";

      var script = document.createElement("script");
      script.src = loaderUrl;
	  var gameInstance = null;
	  var unityInstance = null;
      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
          progressBarFull.style.width = 100 * progress + "%";
        }).then((unityInstance) => {
		  gameInstance = unityInstance;
		  this.unityInstance = unityInstance;
          loadingBar.style.display = "none";		  
        }).catch((message) => {
          alert(message);
        });
      };
	  
	  document.addEventListener("visibilitychange", function () {
	    if (document.visibilityState === "visible") {
			console.log('GDN : VB');
            gameInstance.SendMessage('YandexSDK', 'OnFocusGained');
	    } else {
			console.log('GDN : INVB');
            gameInstance.SendMessage('YandexSDK', 'OnFocusLost');
        }
      });
	  
	  window.addEventListener("focus", onfocus);
	  function onfocus(event){
		console.log('GDN : fcs');
		gameInstance.SendMessage('YandexSDK', 'OnFocusGained');
	  }
	  
	  window.addEventListener("blur", onblur);
	  function onblur(event){
		console.log('GDN : blr');
		gameInstance.SendMessage('YandexSDK', 'OnFocusLost');
	  }
	  
      document.body.appendChild(script);
    </script>
</body>
</html>
