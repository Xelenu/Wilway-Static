<!DOCTYPE html>
<html style="width: 100%; height: 100%">
<head>
  <meta charset="UTF-8">
  <title>Ruffle: The Binding of Isaac Demo</title>
  <meta name="robots" content="noindex, nofollow, noimageindex" />
  <style>
    body {
      background-color: black;
    }
    #ruffle_content {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      height: 100vh;
      width: 100vw;
    }
    #warnings {
      display: none;
      pointer-events: none;
    }
    .small #warnings {
      display: block;
      position: absolute;
      color: white;
      width: 100%;
      font-family: arial, helvetica, sans-serif;
      font-weight: bold;
      font-size: 14px;
    }
    #warning-text {
      margin-bottom: 160px;
      margin-top: 4px;
    }
    #startFlashBtn {
      display: block;
      margin: 0px auto;
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
    }
    div.icon {
      position: relative;
      display: inline-block;
    }
    div.icon > img {
      max-width: 100%;
      min-width: 360px;
    }
    .small div.icon {
      width: 220px;
      display: inline-flex;
    }
    .small div.icon > img {
      width: 220px;
      min-width: 220px;
    }
    ruffle-player {
      margin: 0px auto;
    }
    #startFlashBtn div.play-over {
      position: absolute;
      top: 0px;
      left: 0px;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.2);
    }
    #startFlashBtn div.play-over::before {
      content: "";
      position: absolute;
      display: block;
      width: 120px;
      height: 120px;
      border-radius: 9999px;
      border: 12px solid rgba(255, 255, 255, 0.7);
      margin-top: -66px;
      margin-left: -66px;
      top: 50%;
      left: 50%;
    }
    #startFlashBtn div.play-over::after {
      content: "";
      position: absolute;
      display: block;
      width: 60px;
      height: 0px;
      border: 40px solid rgba(255, 255, 255, 0.5);
      border-width: 40px 0px 40px 80px;
      border-color: transparent transparent transparent rgba(255, 255, 255, 0.7);
      top: 50%;
      left: 50%;
      margin-left: -26px;
      margin-top: -34px;
    }
    #startFlashBtn:hover div.play-over {
      background-color: rgba(0, 0, 0, 0.5);
    }
    #startFlashBtn:hover div.play-over::before {
      border: 12px solid white;
    }
    #startFlashBtn:hover div.play-over::after {
      border-color: transparent transparent transparent white;
    }
    #startFlashBtn div.play-over::before,
    #startFlashBtn div.play-over::after {
      filter: drop-shadow(9px 4px 6px rgba(0, 0, 0, 0.65));
    }
    .small #startFlashBtn {
      padding-bottom: 40px;
      margin-top: 40px;
    }
    .small #startFlashBtn div.play-over::before {
      width: 60px;
      height: 60px;
      border-radius: 9999px;
      border-width: 6px;
      margin-top: -33px;
      margin-left: -33px;
    }
    .small #startFlashBtn div.play-over::after {
      width: 30px;
      border-width: 20px 0px 20px 40px;
      margin-top: -17px;
      margin-left: -13px;
    }
    .small #startFlashBtn div.play-over::before,
    .small #startFlashBtn div.play-over::after {
      filter: drop-shadow(4.5px 2px 3px rgba(0, 0, 0, 0.65));
    }
    .small #startFlashBtn:hover div.play-over::before {
      border-width: 6px;
    }
  </style>
</head>
<body style="margin: 0px; padding: 0px; width: 100%; height: 100%">
  <div id="ruffle_content" style="width:100%; height:100%">
    <button id="startFlashBtn">
      <div class="icon">
        <img src="/core/gam-scripts/the-binding-of-isaac/flash_581168_card.webp" alt="simga"/>
        <div class="play-over"></div>
      </div>
    </button>
    <div id="warnings">
      <p id="warning-text">⚠️ May not be compatible with your device.</p>
      <p id="play-anyway">Play Anyway?</p>
    </div>
  </div>
  <script>
    // Loader config: adjust if you change your asset paths!
    const RUFFLE_JS_URL = '/core/gam-scripts/the-binding-of-isaac/lib/core.ruffle.a31fb2448657cb115403.js';
    const SWF_URL = '/core/gam-scripts/the-binding-of-isaac/lib/581168_Isaac_demo_Secure.swf';
    const PUBLIC_PATH = '/core/gam-scripts/the-binding-of-isaac/lib/';
    const WIDTH = 640;
    const HEIGHT = 480;
    const ICON_URL = "https://picon.ngfiles.com/581000/flash_581168_card.png";

    // UI tweak: if you want to display "small" on mobile, uncomment below
    // if (/Mobi|Android/i.test(navigator.userAgent)) document.body.classList.add('small');

    // Loader logic (classic style, but static)
    (() => {
      const startButton = document.getElementById('startFlashBtn');
      const container = document.getElementById('ruffle_content');
      startButton.innerHTML = `
        <div class="icon">
          <img src="${ICON_URL}" alt="Isaac Demo Icon"/>
          <div class="play-over"></div>
        </div>
      `;
      let preReq = { ruffleJS: 0, audio: 0 };

      function preReqUpdated() {
        if (preReq.ruffleJS && preReq.audio) {
          // Wait until Ruffle is fully registered (for async/slow loading)
          if (!window.RufflePlayer || typeof window.RufflePlayer.newest !== "function") {
            setTimeout(preReqUpdated, 50);
            return;
          }
          let ruffle = window.RufflePlayer.newest();
          let player = ruffle.createPlayer();

          container.innerHTML = '';
          container.appendChild(player);

          player.ruffle().load({
            publicPath: PUBLIC_PATH,
            url: SWF_URL,
            parameters: {},
            autoplay: 'on',
            allowScriptAccess: true,
            allowFullScreen: true,
            forceScale: true,
            scale: 'showAll',
            letterbox: 'fullscreen'
          }).then(() => {
            // Game loaded!
          });

          // Responsive scaling
          function scalePlayer(w, h) {
            player.style.width = w + "px";
            player.style.height = h + "px";
            player.style.maxWidth = "98vw";
            player.style.maxHeight = "80vh";
          }
          window.onresize = function () { scalePlayer(WIDTH, HEIGHT); };
          scalePlayer(WIDTH, HEIGHT);
        }
      }

      // Load Ruffle script
      const head = document.getElementsByTagName("head")[0];
      const ruffleJSScript = document.createElement("script");
      ruffleJSScript.onload = function () {
        preReq.ruffleJS = 1;
        preReqUpdated();
      };
      ruffleJSScript.src = RUFFLE_JS_URL;
      head.appendChild(ruffleJSScript);

      // Click = Play audio (to unlock Flash audio), then load game
      startButton.addEventListener('click', function (e) {
        e.preventDefault();
        e.stopPropagation();
        startButton.remove();

        // Unlock audio autoplay (browser requirement)
        var audioUrl = "data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV";
        var audioElement = document.createElement('audio');
        audioElement.addEventListener('playing', function () {
          preReq.audio = 1;
          preReqUpdated();
        });
        document.body.appendChild(audioElement);
        audioElement.setAttribute('src', audioUrl);
        audioElement.load();
        audioElement.play();
      });
    })();
  </script>
</body>
</html>
