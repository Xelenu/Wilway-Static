<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proxcyou</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
body {
    margin: 0;
    padding: 0;
    font-family: Impact, 'Poppins', "Arial Black", "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: #e0f7fa;
}

#searchContainer {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 600px;
    max-width: 90%;
    background: #1c3d4f;
    z-index: 1001;
    padding: 8px;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

#urlInput {
    width: 75%;
    padding: 6px;
    font-size: 14px;
    background: #2a5a75;
    color: #e0f7fa;
    border: 1px solid #4b8aa6;
    border-radius: 4px;
}

#loadButton {
    padding: 6px 12px;
    font-size: 14px;
    background: darkcyan;
    color: #e0f7fa;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

#loadButton:hover {
    background: #004d4d;
}

#statusMessage {
    color: #ff6b6b;
    font-size: 12px;
    margin: 5px 0;
}

#toggleSearchButton {
    position: fixed;
    top: 10px;
    right: 10px;
    padding: 6px 12px;
    font-size: 14px;
    z-index: 1002;
    background: #006666;
    color: #e0f7fa;
    border: none;
    border-radius: 2px;
    cursor: pointer;
}

#toggleSearchButton:hover {
    background: #004d4d;
}

#contentFrame {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    border: none;
    z-index: 1000;
    display: none;
}

#loadingOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(10, 30, 43, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #e0f7fa;
    font-size: 20px;
    z-index: 1003;
}

.hidden {
    display: none !important;
}

.error-page {
    font-family: Impact, Poppins, sans-serif;
    color: #e0f7fa;
    text-align: center;
    font-size: 18px;
    padding: 50px;
    background-color: #1c3d4f;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.error-page button {
    margin-top: 20px;
    padding: 8px 16px;
    font-size: 14px;
    background: #006666;
    color: #e0f7fa;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.error-page button:hover {
    background: #004d4d;
}
    </style>
</head>
<body>
    <div id="searchContainer">
        <input type="text" id="urlInput" placeholder="Where do you want to go?">
        <button id="loadButton">Go</button>
        <div id="statusMessage"></div>
    </div>
    <button id="toggleSearchButton">ðŸ”½</button>
    <iframe id="contentFrame"></iframe>
    <div id="loadingOverlay" class="hidden">Loading...</div>

    <script>
    'use strict';

    const iframe = document.querySelector('#contentFrame');
    const loadingOverlay = document.querySelector('#loadingOverlay');
    const urlInput = document.querySelector('#urlInput');
    const loadButton = document.querySelector('#loadButton');
    const statusMessage = document.querySelector('#statusMessage');
    const toggleSearchButton = document.querySelector('#toggleSearchButton');
    const searchContainer = document.querySelector('#searchContainer');
    const baseProxyUrl = 'https://toothpaste.bekekes390.workers.dev/?url=';

    function showLoadingOverlay() {
        console.log('Showing loading overlay');
        loadingOverlay.classList.remove('hidden');
    }

    function hideLoadingOverlay() {
        console.log('Hiding loading overlay');
        loadingOverlay.classList.add('hidden');
    }

    function setStatusMessage(message, isError = false) {
        statusMessage.textContent = message;
        statusMessage.style.color = isError ? '#ff6b6b' : '#e0f7fa';
    }

    function loadIframe(url) {
        if (!url) {
            setStatusMessage('Please enter a URL', true);
            return;
        }
        if (!url.match(/^https?:\/\//)) {
            url = 'https://' + url;
        }
        showLoadingOverlay();
        setStatusMessage('');
        console.log(`Loading URL: ${url}`);

        try {
            const proxyUrl = `${baseProxyUrl}${encodeURIComponent(url)}`;
            console.log(`Proxy URL: ${proxyUrl}`);

            iframe.src = proxyUrl;
            iframe.style.display = 'block';

            iframe.onload = () => {
                console.log('Iframe loaded successfully');
                hideLoadingOverlay();
            };

            iframe.onerror = (error) => {
                console.error(`Iframe failed to load: ${error}`);
                setStatusMessage('Failed to load URL, possibly blocked by security restrictions', true);
                hideLoadingOverlay();
            };

            setTimeout(() => {
                if (!iframe.contentDocument) {
                    console.warn('Iframe load check timeout');
                    setStatusMessage('Load timed out', true);
                    hideLoadingOverlay();
                }
            }, 10000);
        } catch (error) {
            console.error(`Error loading iframe: ${error.message}`);
            setStatusMessage('Error loading URL', true);
            hideLoadingOverlay();
        }
    }

    // Bind events
    urlInput.addEventListener('keypress', e => {
        if (e.key === 'Enter' && urlInput.value.trim()) {
            loadIframe(urlInput.value.trim());
        }
    });

    loadButton.addEventListener('click', () => {
        if (urlInput.value.trim()) {
            loadIframe(urlInput.value.trim());
        } else {
            setStatusMessage('Please enter a URL', true);
        }
    });

    toggleSearchButton.addEventListener('click', () => {
        searchContainer.classList.toggle('hidden');
        toggleSearchButton.textContent = searchContainer.classList.contains('hidden') ? 'ðŸ”¼' : 'ðŸ”½';
    });

    window.addEventListener('message', e => {
        if (e.data.type === 'navigate') {
            console.log(`Intercepted navigation to: ${e.data.url}`);
            urlInput.value = e.data.url;
            loadIframe(e.data.url);
        }
    });
    </script>
</body>
</html>
