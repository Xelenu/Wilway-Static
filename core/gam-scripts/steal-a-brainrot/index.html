<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta http-equiv="Content-Security-Policy" content="child-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; connect-src 'self' *.allwebgames.com *.eponesh.com *.gameanalytics.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.unity3d.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.net *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de wss://*.eponesh.com:* www.google-analytics.com www.googletagmanager.com yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yandexmetrica.com yastatic.net; default-src 'self'; font-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com data: fonts.gstatic.com games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastat.net yastatic.net; frame-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com games.yango.com gametok.com igrotok.com juegocasa.com localhost playhop.com wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastatic.net; img-src 'self' *.allwebgames.com *.eponesh.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.net *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastatic.net; media-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.net *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; object-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; script-src 'self' 'unsafe-eval' 'unsafe-inline' *.allwebgames.com *.eponesh.com *.gameanalytics.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.ya.ru *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net abt.s3.yandex.net allwebgames.com blob: data: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de www.google-analytics.com www.googletagmanager.com ya.ru yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz yastatic.net; style-src 'self' 'unsafe-eval' 'unsafe-inline' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: data: fonts.googleapis.com games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz; worker-src 'self' *.allwebgames.com *.games.yango.com *.gametok.com *.igrotok.com *.juegocasa.com *.playhop.com *.website.yandexcloud.net *.wowspiele.de *.yandex.az *.yandex.by *.yandex.co.il *.yandex.com *.yandex.com.am *.yandex.com.ge *.yandex.com.tr *.yandex.ee *.yandex.fr *.yandex.kg *.yandex.kz *.yandex.lt *.yandex.lv *.yandex.md *.yandex.ru *.yandex.tj *.yandex.tm *.yandex.ua *.yandex.uz *.yango.games-store.net allwebgames.com blob: games.yango.com gametok.com igrotok.com juegocasa.com playhop.com storage.yandexcloud.net wowspiele.de yandex.az yandex.by yandex.co.il yandex.com yandex.com.am yandex.com.ge yandex.com.tr yandex.ee yandex.fr yandex.kg yandex.kz yandex.lt yandex.lv yandex.md yandex.ru yandex.tj yandex.tm yandex.ua yandex.uz"/>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <link rel="stylesheet" href="./style.css"/>
    <!-- Yandex Games SDK -->
    <script src="/core/gam-scripts/steal-a-brainrot/sdk.js"></script>
    <style>
        canvas:focus { outline: none; }
        html, body {
            padding: 0;
            margin: 0;
            overflow: hidden;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: rgba(0,0,0,0);
            height: 100%;
        }
    </style>
</head>
<body class="dark">
<div id="unity-container" class="unity-desktop">
    <canvas id="unity-canvas" tabindex="-1"></canvas>
</div>
<div id="loading-cover" style="display:none;">
    <div id="unity-loading-bar">
        <div id="unity-logo"><img src="Images/logo.png"/></div>
        <div id="unity-progress-bar-empty" style="display: none;">
            <div id="unity-progress-bar-full"></div>
        </div>
        <div class="spinner"></div>
    </div>
</div>
<script>
const hideFullScreenButton = "";
const buildUrl = "Build";
const loaderUrl = buildUrl + "/StealBrainrot.loader.js";
const wasmBaseName = "b7cf28e445ff2ecea47d5697909bb345.wasm.br";
const config = {
    dataUrl: buildUrl + "/d6ccccaf266bab16bf58f5725e76504e.data.br",
    frameworkUrl: buildUrl + "/8b2e24a34eb309de7efc1aeb6e648233.js.br",
    codeUrl: buildUrl + "/b7cf28e445ff2ecea47d5697909bb345.wasm.br",
    streamingAssetsUrl: "StreamingAssets",
    companyName: "NagamiGames",
    productName: "BikeOfHell",
    productVersion: "0.1"
};
const container = document.querySelector("#unity-container");
const canvas = document.querySelector("#unity-canvas");
const loadingCover = document.querySelector("#loading-cover");
const progressBarEmpty = document.querySelector("#unity-progress-bar-empty");
const progressBarFull = document.querySelector("#unity-progress-bar-full");
const spinner = document.querySelector('.spinner');

(async function () {
    // Mobile class
    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
    }
    loadingCover.style.display = "";

    // --- WASM multipart loader ---
    async function urlExists(url) {
        try {
            const resp = await fetch(url, { method: 'HEAD' });
            return resp.ok;
        } catch { return false; }
    }
    async function discoverWasmParts(baseUrl) {
        let partUrls = [];
        let i = 0;
        while (true) {
            let partUrl = `${baseUrl}.part${i}`;
            if (await urlExists(partUrl)) {
                partUrls.push(partUrl);
                i++;
            } else {
                break;
            }
        }
        return partUrls;
    }
    async function fetchAndCombineParts(partUrls) {
        const arrays = [];
        for (const url of partUrls) {
            const resp = await fetch(url);
            if (!resp.ok) throw new Error("Failed to fetch part: " + url);
            arrays.push(new Uint8Array(await resp.arrayBuffer()));
        }
        let totalLen = arrays.reduce((sum, arr) => sum + arr.length, 0);
        let combined = new Uint8Array(totalLen);
        let offset = 0;
        for (const arr of arrays) {
            combined.set(arr, offset);
            offset += arr.length;
        }
        return combined;
    }

    // -- Main load logic --
    const wasmUrl = `${buildUrl}/${wasmBaseName}`;
    const partUrls = await discoverWasmParts(wasmUrl);
    if (partUrls.length > 0) {
        const combinedWasm = await fetchAndCombineParts(partUrls);
        const wasmBlob = new Blob([combinedWasm], {type: "application/octet-stream"});
        const wasmBlobUrl = URL.createObjectURL(wasmBlob);
        config.codeUrl = wasmBlobUrl;
        console.log("Loaded WASM from split parts:", partUrls.length, "parts");
    } else {
        config.codeUrl = wasmUrl;
        console.log("Loaded WASM from single file");
    }

    // --- YSDK / Unity integration and game logic ---
    let StartUnityInstance;
    let ygGameInstance = null;
    let ysdk = null;
    let initYSDK = false;
    let initGame = false;
    let syncInit = false;
    const NO_DATA = 'no data';

    document.addEventListener('contextmenu', event => event.preventDefault());
    function FocusGame() { window.focus(); canvas.focus(); }
    window.addEventListener('pointerdown', FocusGame);
    window.addEventListener('touchstart', FocusGame);

    document.addEventListener('visibilitychange', function () {
        if (ysdk !== null && initGame === true) {
            if (document.hidden) {
                YG2Instance('SetFocusWindowGame', 'false');
            }
            else {
                YG2Instance('SetFocusWindowGame', 'true');
                if ((ysdk.deviceInfo.isMobile() || ysdk.deviceInfo.isTablet()) && ysdk.screen.fullscreen.status == 'off')
                    ysdk.screen.fullscreen.request();
            }
        }
    });

    function StartUnityInstance_IfUnloaded() {
        if (spinner.style.display !== "none")
            StartUnityInstance();
    }
    function IsLocalHost() {
        try {
            if (window.top !== window) {
                console.warn("The application is running in an iframe");
                return false;
            }
            const host = window.location.hostname;
            if (host === "localhost" || host === "127.0.0.1" || host.endsWith(".local")) {
                LogStyledMessage("Local Host");
                return true;
            }
        } catch (error) {
            console.error("Error checking the local host:", error);
            return false;
        }
    }

    function YG2Instance(method) {
        if (ygGameInstance == null) return;
        if (!initGame) {
            setTimeout(function () {
                if (ygGameInstance)
                    ygGameInstance.SendMessage('YG2Instance', method);
            }, 100);
        } else {
            ygGameInstance.SendMessage('YG2Instance', method);
        }
    }
    function YG2InstanceArg(method, arg) {
        if (ygGameInstance == null) return;
        if (!initGame) {
            setTimeout(function () {
                ygGameInstance.SendMessage('YG2Instance', method, arg);
            }, 100);
        } else {
            ygGameInstance.SendMessage('YG2Instance', method, arg);
        }
    }

    function LogStyledMessage(message, style) {
        if (style)
            console.log('%c' + message, style);
        else
            console.log('%c' + message, 'color: #FFDF73; background-color: #454545');
    }

    // YSDK/game boot
    InitYSDK();
    async function InitYSDK() {
        try {
            if (IsLocalHost()) return;
            ysdk = await YaGames.init();
            InterAdvShow();
            await RequestingEnvironmentData();
            LogStyledMessage('Init EnvirData ysdk');
            await InitPlayer();
            LogStyledMessage('Init Authorization ysdk');
            await LoadCloud();
            LogStyledMessage('Init Storage ysdk');
            await InitPayments();
            LogStyledMessage('Init Payments ysdk');
            initYSDK = true;
            if (ygGameInstance != null)
                ygGameInstance.SendMessage('YG2Instance', 'InitSDKComplete');
            LogStyledMessage('Init YandexSDK Success');
        } catch (e) {
            console.error('CRASH Initialization SDK: ', e);
        }
        if (!IsLocalHost() && !syncInit)
            StartUnityInstance_IfUnloaded();
    }

    function InitGame() {
        initGame = true;
        setTimeout(function () {
            if (nowFullAdOpen == true)
                YG2Instance('OpenInterAdv');
        }, 100);
    }

    LogStyledMessage('PluginYG2 v2.0032  build: 11');

    var cloudSaves = NO_DATA;
    function SaveCloud(jsonData, flush) {
        if (player == null) {
            console.error('CRASH Save Cloud: ', 'Didnt have time to load');
            return;
        }
        try {
            player.setData({ saves: [jsonData] }, flush);
        } catch (e) {
            console.error('CRASH Save Cloud: ', e.message);
        }
    }
    function LoadCloud() {
        return new Promise((resolve) => {
            if (ysdk == null) { Final(NO_DATA); return; }
            try {
                player.getData(["saves"]).then(data => {
                    if (data.saves) {
                        Final(JSON.stringify(data.saves));
                    } else {
                        Final(NO_DATA);
                    }
                }).catch(() => {
                    console.error('Load Cloud Error!');
                    Final(NO_DATA);
                });
            }
            catch (e) {
                console.error('CRASH Load saves Cloud: ', e.message);
                Final(NO_DATA);
            }
            function Final(res) {
                cloudSaves = res;
                YG2Instance('SetLoadSaves', res);
                resolve(res);
            }
        });
    }
    function StickyAdActivity(show) {
        try {
            ysdk.adv.getBannerAdvStatus().then(({ stickyAdvIsShowing, reason }) => {
                if (stickyAdvIsShowing) {
                    if (!show) ysdk.adv.hideBannerAdv();
                }
                else if (reason) {
                    LogStyledMessage('StickyAdv are not shown. Reason:', reason);
                }
                else if (show) {
                    ysdk.adv.showBannerAdv();
                }
            })
        } catch (e) {
            console.error('CRASH StickyAdv activity: ', e.message);
        }
    }
    function RewardedAdvShow(id) {
        try {
            ysdk.adv.showRewardedVideo({
                callbacks: {
                    onOpen: () => {
                        LogStyledMessage('Opened Rewarded Adv');
                        YG2Instance('OpenRewardedAdv');
                    },
                    onClose: () => {
                        LogStyledMessage('Closed Rewarded Adv');
                        YG2Instance('CloseRewardedAdv');
                        FocusGame();
                    },
                    onRewarded: () => {
                        YG2InstanceArg('RewardAdv', id);
                    },
                    onError: (err) => {
                        console.error('Error Rewarded Adv', err);
                        YG2Instance('ErrorRewardedAdv');
                    }
                }
            });
        } catch (err) {
            console.error('CRASH Rewarded Adv Show: ', err.message);
        }
    }

    var paymentsData = NO_DATA;
    let payments = null;
    function InitPayments(sendback) {
        return new Promise((resolve) => {
            try {
                if (ysdk == null) { Final(NO_DATA); return; }
                ysdk.getPayments().then(_payments => {
                    payments = _payments;
                    payments.getCatalog().then(products => {
                        let productID = [], title = [], description = [], imageURI = [],
                            price = [], priceValue = [], priceCurrencyCode = [],
                            currencyImageURL = [], consumed = [];
                        payments.getPurchases().then(purchases => {
                            for (let i = 0; i < products.length; i++) {
                                productID[i] = products[i].id;
                                title[i] = products[i].title;
                                description[i] = products[i].description;
                                imageURI[i] = products[i].imageURI;
                                price[i] = products[i].price;
                                priceValue[i] = products[i].priceValue;
                                priceCurrencyCode[i] = products[i].priceCurrencyCode;
                                currencyImageURL[i] = products[i].getPriceCurrencyImage("medium");
                                consumed[i] = true;
                                for (let i2 = 0; i2 < purchases.length; i2++) {
                                    if (purchases[i2].productID === productID[i]) {
                                        consumed[i] = false;
                                        break;
                                    }
                                }
                            }
                            let jsonPayments = {
                                "id": productID, "title": title, "description": description,
                                "imageURI": imageURI, "price": price, "priceValue": priceValue,
                                "priceCurrencyCode": priceCurrencyCode, "currencyImageURL": currencyImageURL,
                                "consumed": consumed, "language": ysdk.environment.i18n.lang
                            };
                            Final(JSON.stringify(jsonPayments));
                        });
                    });
                }).catch(e => {
                    LogStyledMessage('Purchases are not available', e.message);
                    Final(NO_DATA);
                })
            } catch (e) {
                console.error('CRASH Init Payments: ', e.message);
                Final(NO_DATA);
            }
            function Final(res) {
                paymentsData = res;
                YG2Instance('PaymentsEntries', res);
                resolve(res);
            }
        });
    }
    function BuyPayments(id) {
        try {
            if (payments != null) {
                payments.purchase(id).then(() => {
                    LogStyledMessage('Purchase Success');
                    ConsumePurchase(id, true);
                    FocusGame();
                }).catch(e => {
                    console.error('Purchase Failed', e.message);
                    YG2InstanceArg('OnPurchaseFailed', id);
                    FocusGame();
                })
            }
            else {
                LogStyledMessage('Payments == null');
                YG2InstanceArg('OnPurchaseFailed', id);
            }
        } catch (e) {
            console.error('CRASH Buy Payments: ', e.message);
            YG2InstanceArg('OnPurchaseFailed', id);
            FocusGame();
        }
    }
    function ConsumePurchase(id, onPurchaseSuccess) {
        try {
            if (payments != null) {
                payments.getPurchases().then(purchases => {
                    for (let i = 0; i < purchases.length; i++) {
                        if (purchases[i].productID === id) {
                            payments.consumePurchase(purchases[i].purchaseToken);
                            if (onPurchaseSuccess)
                                YG2InstanceArg('OnPurchaseSuccess', id);
                        }
                    }
                });
            }
            else {
                LogStyledMessage('Consume purchase: payments null');
            }
        } catch (e) {
            console.error('CRASH Consume Purchase: ', e.message);
        }
    }
    function ConsumePurchases(onPurchaseSuccess) {
        try {
            if (payments != null) {
                payments.getPurchases().then(purchases => {
                    LogStyledMessage('Unprocessed purchases: ', purchases.length);
                    for (let i = 0; i < purchases.length; i++) {
                        payments.consumePurchase(purchases[i].purchaseToken);
                        if (onPurchaseSuccess)
                            YG2InstanceArg('OnPurchaseSuccess', purchases[i].productID);
                    }
                });
            }
            else {
                LogStyledMessage('Consume purchases: payments null');
            }
        } catch (e) {
            console.error('CRASH Consume purchases: ', e.message);
        }
    }

    let nowFullAdOpen = false;
    function InterAdvShow() {
        try {
            if (ysdk == null) {
                LogStyledMessage('Cancel InterAdvShow: SDK is not initialized');
                return;
            }
            if (nowFullAdOpen == true) {
                LogStyledMessage('Cancel InterAdvShow: The advertisement is already open');
                return;
            }
            ysdk.adv.showFullscreenAdv({
                callbacks: {
                    onOpen: () => {
                        LogStyledMessage('Open Interstitial Adv');
                        nowFullAdOpen = true;
                        if (initGame === true) {
                            YG2Instance('OpenInterAdv');
                        }
                    },
                    onClose: (wasShown) => {
                        LogStyledMessage('Close Interstitial Adv');
                        nowFullAdOpen = false;
                        if (initGame === true) {
                            if (wasShown) {
                                YG2InstanceArg('CloseInterAdv', 'true');
                            }
                            else {
                                YG2InstanceArg('CloseInterAdv', 'false');
                            }
                        }
                        FocusGame();
                    },
                    onError: (error) => {
                        console.error('Error Interstitial Adv', error);
                        nowFullAdOpen = false;
                        YG2Instance('ErrorInterAdv');
                        FocusGame();
                    }
                }
            });
        }
        catch (e) {
            console.error('CRASH Interstitial Adv Show: ', e.message);
        }
    }

    var environmentData = NO_DATA;
    function RequestingEnvironmentData() {
        return new Promise((resolve) => {
            if (ysdk == null) { Final(NO_DATA); return; }
            try {
                var browser = 'Other';
                if (browser.includes('YaBrowser') || browser.includes('YaSearchBrowser')) browser = 'Yandex';
                else if (browser.includes('Opera') || browser.includes('OPR')) browser = 'Opera';
                else if (browser.includes('Firefox')) browser = 'Firefox';
                else if (browser.includes('MSIE')) browser = 'IE';
                else if (browser.includes('Edge')) browser = 'Edge';
                else if (browser.includes('Chrome')) browser = 'Chrome';
                else if (browser.includes('Safari')) browser = 'Safari';

                let jsonEnvir = {
                    "language": ysdk.environment.i18n.lang,
                    "domain": ysdk.environment.i18n.tld,
                    "deviceType": ysdk.deviceInfo.type,
                    "isMobile": ysdk.deviceInfo.isMobile(),
                    "isDesktop": ysdk.deviceInfo.isDesktop(),
                    "isTablet": ysdk.deviceInfo.isTablet(),
                    "isTV": ysdk.deviceInfo.isTV(),
                    "appID": ysdk.environment.app.id,
                    "browserLang": ysdk.environment.browser.lang,
                    "payload": ysdk.environment.payload,
                    "platform": navigator.platform,
                    "browser": browser
                };
                Final(JSON.stringify(jsonEnvir));
                LogStyledMessage("Environment Data: " + JSON.stringify(jsonEnvir));
            }
            catch (e) {
                console.error('CRASH Requesting Environment Data: ', e.message);
                Final(NO_DATA);
            }
            function Final(res) {
                environmentData = res;
                YG2InstanceArg('SetEnvirData', res);
                resolve(res);
            }
        });
    }

    var playerData = NO_DATA;
    let player = null;
    async function InitPlayer() {
        return new Promise(async (resolve) => {
            try {
                if (!ysdk)
                    return Final(NotAuthorized());
                player = await ysdk.getPlayer();
                if (!player.isAuthorized())
                    return Final(NotAuthorized());
                const authJson = {
                    "playerAuth": "resolved",
                    "playerName": player.getName(),
                    "playerId": player.getUniqueID(),
                    "playerPhoto": player.getPhoto('small'),
                    "payingStatus": player.getPayingStatus()
                };
                return Final(JSON.stringify(authJson));
            } catch (e) {
                console.error('CRASH init Player: ', e.message);
                return Final(NotAuthorized());
            }
            function Final(res) {
                playerData = res;
                YG2InstanceArg('SetAuth', res);
                resolve(res);
            }
        });
    }
    function NotAuthorized() {
        let authJson = {
            "playerAuth": "rejected",
            "playerName": "unauthorized",
            "playerId": "unauthorized",
            "playerPhoto": "no data",
            "payingStatus": "unknown"
        };
        return JSON.stringify(authJson);
    }
    function OpenAuthDialog() {
        if (ysdk !== null) {
            try {
                ysdk.auth.openAuthDialog().then(() => {
                    InitPlayer()
                        .then(() => {
                            YG2Instance('LoggedIn');
                        });
                });
            }
            catch (e) {
                LogStyledMessage('CRASH Open Auth Dialog: ', e.message);
            }
        }
    }

    // --- Load Unity loader after config is patched
    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
        StartUnityInstance = function () {
            createUnityInstance(canvas, config, (progress) => {
                spinner.style.display = "none";
                progressBarEmpty.style.display = "";
                const adjustedProgress = Math.max(progress, 0.05);
                progressBarFull.style.width = `${100 * adjustedProgress}%`;
            }).then((unityInstance) => {
                ygGameInstance = unityInstance;
                loadingCover.style.display = "none";
            }).catch((message) => {
                console.error(message);
            });
        };
        if (IsLocalHost() || syncInit)
            StartUnityInstance_IfUnloaded();
    };
    document.body.appendChild(script);
})();
</script>
</body>
</html>
