<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Binding of Isaac Demo (Ruffle Player)</title>
  <style>
    body {
      background: #181818;
      color: #f8f8f2;
      font-family: Arial, Helvetica, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    h1 {
      margin-top: 32px;
      letter-spacing: 2px;
      font-weight: bold;
      font-size: 2.2em;
      text-shadow: 0 2px 6px #000a;
    }
    #ruffle_content {
      margin-top: 18px;
    }
    #startFlashBtn {
      margin-top: 28px;
      padding: 18px 34px;
      font-size: 1.25em;
      background: #7c5549;
      color: #fff;
      border: none;
      border-radius: 11px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 4px 20px #0004;
      display: flex;
      align-items: center;
      gap: 14px;
      transition: background 0.18s;
    }
    #startFlashBtn:hover {
      background: #a66a59;
    }
    #startFlashBtn img {
      width: 42px;
      height: 42px;
      border-radius: 8px;
      box-shadow: 0 2px 10px #0008;
      vertical-align: middle;
    }
    @media (max-width: 700px) {
      #ruffle_content {
        width: 100vw;
      }
    }
  </style>
</head>
<body>
  <h1>The Binding of Isaac<br>Demo (Flash + Ruffle)</h1>
  <div id="ruffle_content"></div>
  <button id="startFlashBtn">
    <img src="https://picon.ngfiles.com/581000/flash_581168_card.png" alt="Isaac Icon">
    Play Demo
  </button>
  <script>
    (() => {
      // Hardcoded resource paths:
      const RUFFLE_JS_URL = '/core/gam-scripts/the-binding-of-isaac/lib/core.ruffle.a31fb2448657cb115403.js';
      const SWF_URL = '/core/gam-scripts/the-binding-of-isaac/lib/581168_Isaac_demo_Secure.swf';
      const WIDTH = 640;
      const HEIGHT = 480;

      const startButton = document.getElementById('startFlashBtn');
      const container = document.getElementById('ruffle_content');
      let preReq = { ruffleJS: 0, audio: 0 };

      function preReqUpdated() {
        if (preReq.ruffleJS && preReq.audio) {
          let ruffle = window.RufflePlayer.newest();
          let player = ruffle.createPlayer();
          container.innerHTML = '';
          container.appendChild(player);

          player.ruffle().load({
            publicPath: '/core/gam-scripts/the-binding-of-isaac/lib/', // where the .wasm is!
            url: SWF_URL,
            parameters: {},
            autoplay: 'on',
            allowScriptAccess: true,
            allowFullScreen: true,
            forceScale: true,
            scale: 'showAll',
            letterbox: 'fullscreen'
          }).then(() => {
            // Game loaded!
          });

          // Scale the player for your dimensions
          function scalePlayer(w, h) {
            player.style.width = w + "px";
            player.style.height = h + "px";
            player.style.maxWidth = "98vw";
            player.style.maxHeight = "80vh";
          }
          window.onresize = function () { scalePlayer(WIDTH, HEIGHT); };
          scalePlayer(WIDTH, HEIGHT);
        }
      }

      // Load Ruffle JS
      const head = document.getElementsByTagName("head")[0];
      const ruffleJSScript = document.createElement("script");
      ruffleJSScript.onload = function () {
        preReq.ruffleJS = 1;
        preReqUpdated();
      };
      ruffleJSScript.src = RUFFLE_JS_URL;
      head.appendChild(ruffleJSScript);

      startButton.addEventListener('click', function (e) {
        e.preventDefault();
        e.stopPropagation();
        startButton.remove();

        // Play a small audio file to unlock autoplay for Flash sounds
        var audioUrl = "data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV";
        var audioElement = document.createElement('audio');
        audioElement.addEventListener('playing', function () {
          preReq.audio = 1;
          preReqUpdated();
        });
        document.body.appendChild(audioElement);
        audioElement.setAttribute('src', audioUrl);
        audioElement.load();
        audioElement.play();
      });
    })();
  </script>
</body>
</html>
